var it=Object.defineProperty;var rt=(u,x,f)=>x in u?it(u,x,{enumerable:!0,configurable:!0,writable:!0,value:f}):u[x]=f;var P=(u,x,f)=>(rt(u,typeof x!="symbol"?x+"":x,f),f);(function(u,x){typeof exports=="object"&&typeof module!="undefined"?x(exports):typeof define=="function"&&define.amd?define(["exports"],x):(u=typeof globalThis!="undefined"?globalThis:u||self,x(u.Kalidokit={}))})(this,function(u){"use strict";const x=(i,t,e)=>Math.max(Math.min(i,e),t),f=(i,t,e)=>(x(i,t,e)-t)/(e-t),D={Face:{eye:{l:1,r:1},mouth:{x:0,y:0,shape:{A:0,E:0,I:0,O:0,U:0}},head:{x:0,y:0,z:0,width:.3,height:.6,position:{x:.5,y:.5,z:0}},brow:0,pupil:{x:0,y:0}},Pose:{RightUpperArm:{x:0,y:0,z:-1.25},LeftUpperArm:{x:0,y:0,z:1.25},RightLowerArm:{x:0,y:0,z:0},LeftLowerArm:{x:0,y:0,z:0},LeftUpperLeg:{x:0,y:0,z:0},RightUpperLeg:{x:0,y:0,z:0},RightLowerLeg:{x:0,y:0,z:0},LeftLowerLeg:{x:0,y:0,z:0},LeftHand:{x:0,y:0,z:0},RightHand:{x:0,y:0,z:0},Spine:{x:0,y:0,z:0},Hips:{position:{x:0,y:0,z:0},rotation:{x:0,y:0,z:0}}},RightHand:{RightWrist:{x:-.1315541586772754,y:-.07882867526197412,z:-1.0417476769631682},RightRingProximal:{x:0,y:0,z:-.13224515812536933},RightRingIntermediate:{x:0,y:0,z:-.4068258603832122},RightRingDistal:{x:0,y:0,z:-.04950943047275125},RightIndexProximal:{x:0,y:0,z:-.24443519921597368},RightIndexIntermediate:{x:0,y:0,z:-.25695509972035424},RightIndexDistal:{x:0,y:0,z:-.06699515077992313},RightMiddleProximal:{x:0,y:0,z:-.09663436414575077},RightMiddleIntermediate:{x:0,y:0,z:-.44945038168605306},RightMiddleDistal:{x:0,y:0,z:-.06660398263230727},RightThumbProximal:{x:-.2349819227955754,y:-.33498192279557526,z:-.12613225518081256},RightThumbIntermediate:{x:-.2,y:-.19959491036565571,z:-.013996364546896928},RightThumbDistal:{x:-.2,y:.002005509674788991,z:.1510027548373945},RightLittleProximal:{x:0,y:0,z:-.09045147788376662},RightLittleIntermediate:{x:0,y:0,z:-.22559206415066682},RightLittleDistal:{x:0,y:0,z:-.10080630460393536}},LeftHand:{LeftWrist:{x:-.1315541586772754,y:-.07882867526197412,z:-1.0417476769631682},LeftRingProximal:{x:0,y:0,z:.13224515812536933},LeftRingIntermediate:{x:0,y:0,z:.4068258603832122},LeftRingDistal:{x:0,y:0,z:.04950943047275125},LeftIndexProximal:{x:0,y:0,z:.24443519921597368},LeftIndexIntermediate:{x:0,y:0,z:.25695509972035424},LeftIndexDistal:{x:0,y:0,z:.06699515077992313},LeftMiddleProximal:{x:0,y:0,z:.09663436414575077},LeftMiddleIntermediate:{x:0,y:0,z:.44945038168605306},LeftMiddleDistal:{x:0,y:0,z:.06660398263230727},LeftThumbProximal:{x:-.2349819227955754,y:.33498192279557526,z:.12613225518081256},LeftThumbIntermediate:{x:-.2,y:.2506506391005022,z:.05046474221464442},LeftThumbDistal:{x:-.2,y:.17880674636490754,z:-.06059662681754624},LeftLittleProximal:{x:0,y:0,z:.1748998529912705},LeftLittleIntermediate:{x:0,y:0,z:.4065799037713114},LeftLittleDistal:{x:0,y:0,z:.10080630460393536}}};var X=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",clamp:x,remap:f,RestingDefault:D});class r{constructor(t,e,n){if(!!t&&t.constructor===Array){this.x=t[0]||0,this.y=t[1]||0,this.z=t[2]||0;return}if(!!t&&t.constructor===Object){this.x=t.x||0,this.y=t.y||0,this.z=t.z||0;return}this.x=t||0,this.y=e||0,this.z=n||0}negative(){return new r(-this.x,-this.y,-this.z)}add(t){return t instanceof r?new r(this.x+t.x,this.y+t.y,this.z+t.z):new r(this.x+t,this.y+t,this.z+t)}subtract(t){return t instanceof r?new r(this.x-t.x,this.y-t.y,this.z-t.z):new r(this.x-t,this.y-t,this.z-t)}multiply(t){return t instanceof r?new r(this.x*t.x,this.y*t.y,this.z*t.z):new r(this.x*t,this.y*t,this.z*t)}divide(t){return t instanceof r?new r(this.x/t.x,this.y/t.y,this.z/t.z):new r(this.x/t,this.y/t,this.z/t)}equals(t){return this.x==t.x&&this.y==t.y&&this.z==t.z}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}cross(t){return new r(this.y*t.z-this.z*t.y,this.z*t.x-this.x*t.z,this.x*t.y-this.y*t.x)}length(){return Math.sqrt(this.dot(this))}distance(t,e=3){return Math.sqrt(e===2?Math.pow(this.x-t.x,2)+Math.pow(this.y-t.y,2):Math.pow(this.x-t.x,2)+Math.pow(this.y-t.y,2)+Math.pow(this.z-t.z,2))}lerp(t,e){return t.subtract(this).multiply(e).add(this)}unit(){return this.divide(this.length())}min(){return Math.min(Math.min(this.x,this.y),this.z)}max(){return Math.max(Math.max(this.x,this.y),this.z)}toAngles(){return{theta:Math.atan2(this.z,this.x),phi:Math.asin(this.y/this.length())}}angleTo(t){return Math.acos(this.dot(t)/(this.length()*t.length()))}toArray(t){return[this.x,this.y,this.z].slice(0,t||3)}clone(){return new r(this.x,this.y,this.z)}init(t,e,n){return this.x=t,this.y=e,this.z=n,this}static negative(t,e){return e.x=-t.x,e.y=-t.y,e.z=-t.z,e}static add(t,e,n){return e instanceof r?(n.x=t.x+e.x,n.y=t.y+e.y,n.z=t.z+e.z):(n.x=t.x+e,n.y=t.y+e,n.z=t.z+e),n}static subtract(t,e,n){return e instanceof r?(n.x=t.x-e.x,n.y=t.y-e.y,n.z=t.z-e.z):(n.x=t.x-e,n.y=t.y-e,n.z=t.z-e),n}static multiply(t,e,n){return e instanceof r?(n.x=t.x*e.x,n.y=t.y*e.y,n.z=t.z*e.z):(n.x=t.x*e,n.y=t.y*e,n.z=t.z*e),n}static divide(t,e,n){return e instanceof r?(n.x=t.x/e.x,n.y=t.y/e.y,n.z=t.z/e.z):(n.x=t.x/e,n.y=t.y/e,n.z=t.z/e),n}static cross(t,e,n){return n.x=t.y*e.z-t.z*e.y,n.y=t.z*e.x-t.x*e.z,n.z=t.x*e.y-t.y*e.x,n}static unit(t,e){let n=t.length();return e.x=t.x/n,e.y=t.y/n,e.z=t.z/n,e}static fromAngles(t,e){return new r(Math.cos(t)*Math.cos(e),Math.sin(e),Math.sin(t)*Math.cos(e))}static randomDirection(){return r.fromAngles(Math.random()*Math.PI*2,Math.asin(Math.random()*2-1))}static min(t,e){return new r(Math.min(t.x,e.x),Math.min(t.y,e.y),Math.min(t.z,e.z))}static max(t,e){return new r(Math.max(t.x,e.x),Math.max(t.y,e.y),Math.max(t.z,e.z))}static lerp(t,e,n){return e instanceof r?e.subtract(t).multiply(n).add(t):(e-t)*n+t}static fromArray(t){return!!t&&t.constructor===Array?new r(t[0],t[1],t[2]):new r(t.x,t.y,t.z)}static angleBetween(t,e){return t.angleTo(e)}static angleBetweenVertices(t,e,n){t.subtract(e),n.subtract(e)}static distance(t,e,n){return Math.sqrt(n===2?Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2):Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)+Math.pow(t.z-e.z,2))}static toDegrees(t){return t*(180/Math.PI)}static normalizeAngle(t){let e=Math.PI*2,n=t%e;return n=n>Math.PI?n-e:n<-Math.PI?e+n:n,n/Math.PI}static normalizeRadians(t){return t>=Math.PI/2&&(t-=2*Math.PI),t<=-Math.PI/2&&(t+=2*Math.PI,t=Math.PI-t),t/Math.PI}static find2DAngle(t,e,n,o){var a=o-e,h=n-t,s=Math.atan2(a,h);return s}static findRotation(t,e,n=!0){return n?new r(r.normalizeRadians(r.find2DAngle(t.z,t.x,e.z,e.x)),r.normalizeRadians(r.find2DAngle(t.z,t.y,e.z,e.y)),r.normalizeRadians(r.find2DAngle(t.x,t.y,e.x,e.y))):new r(r.find2DAngle(t.z,t.x,e.z,e.x),r.find2DAngle(t.z,t.y,e.z,e.y),r.find2DAngle(t.x,t.y,e.x,e.y))}static rollPitchYaw(t,e,n){if(!n)return new r(r.normalizeAngle(r.find2DAngle(t.z,t.y,e.z,e.y)),r.normalizeAngle(r.find2DAngle(t.z,t.x,e.z,e.x)),r.normalizeAngle(r.find2DAngle(t.x,t.y,e.x,e.y)));let o=e.subtract(t),a=n.subtract(t),s=o.cross(a).unit(),y=o.unit(),l=s.cross(y),z=Math.asin(s.x)||0,g=Math.atan2(-s.y,s.z)||0,p=Math.atan2(-l.x,y.x)||0;return new r(r.normalizeAngle(g),r.normalizeAngle(z),r.normalizeAngle(p))}static angleBetween3DCoords(t,e,n){t instanceof r||(t=new r(t),e=new r(e),n=new r(n));const o=t.subtract(e),a=n.subtract(e),h=o.unit(),s=a.unit(),y=h.dot(s),l=Math.acos(y);return r.normalizeRadians(l)}}const H=i=>{let t={r:r.findRotation(i[11],i[13]),l:r.findRotation(i[12],i[14])};t.r.y=r.angleBetween3DCoords(i[12],i[11],i[13]),t.l.y=r.angleBetween3DCoords(i[11],i[12],i[14]);let e={r:r.findRotation(i[13],i[15]),l:r.findRotation(i[14],i[16])};e.r.y=r.angleBetween3DCoords(i[11],i[13],i[15]),e.l.y=r.angleBetween3DCoords(i[12],i[14],i[16]),e.r.z=x(e.r.z,-2.14,0),e.l.z=x(e.l.z,-2.14,0);let n={r:r.findRotation(r.fromArray(i[15]),r.lerp(r.fromArray(i[17]),r.fromArray(i[19]),.5)),l:r.findRotation(r.fromArray(i[16]),r.lerp(r.fromArray(i[18]),r.fromArray(i[20]),.5))},o=B(t.r,e.r,n.r,"Right"),a=B(t.l,e.l,n.l,"Left");return{UpperArm:{r:o.UpperArm,l:a.UpperArm},LowerArm:{r:o.LowerArm,l:a.LowerArm},Hand:{r:o.Hand,l:a.Hand},Unscaled:{UpperArm:t,LowerArm:e,Hand:n}}},B=(i,t,e,n="right")=>{const o=n==="Right"?1:-1;return i.z*=-2.3*o,i.y*=Math.PI*o,i.y-=Math.max(t.x),i.y-=-o*Math.max(t.z,0),i.x-=.3*o,t.z*=-2.14*o,t.y*=2.14*o,t.x*=2.14*o,i.x=x(i.x,-.5,Math.PI),t.x=x(t.x,-.3,.3),e.y=x(e.z*2,-.6,.6),e.z=e.z*-2.3*o,{UpperArm:i,LowerArm:t,Hand:e}},U=(i,t)=>{let e=r.fromArray(t[23]),n=r.fromArray(t[24]),o=r.fromArray(t[11]),a=r.fromArray(t[12]),h=e.lerp(n),s=o.lerp(a),y=h.distance(s),l={position:{x:x(-1*(h.x-.65),-1,1),y:0,z:x(y-1,-2,0)},rotation:null};l.rotation=r.rollPitchYaw(i[23],i[24]),l.rotation.y>.5&&(l.rotation.y-=2),l.rotation.y+=.5,l.rotation.z>0&&(l.rotation.z=1-l.rotation.z),l.rotation.z<0&&(l.rotation.z=-1-l.rotation.z);let z=f(Math.abs(l.rotation.y),.2,.4);l.rotation.z*=1-z,l.rotation.x=0;let g=r.rollPitchYaw(i[11],i[12]);g.y>.5&&(g.y-=2),g.y+=.5,g.z>0&&(g.z=1-g.z),g.z<0&&(g.z=-1-g.z);let p=f(Math.abs(g.y),.2,.4);return g.z*=1-p,g.x=0,N(l,g)},N=(i,t)=>(i.rotation.x*=Math.PI,i.rotation.y*=Math.PI,i.rotation.z*=Math.PI,i.worldPosition={x:i.position.x*(.5+1.8*-i.position.z),y:0,z:i.position.z*(.1+i.position.z*-2)},t.x*=Math.PI,t.y*=Math.PI,t.z*=Math.PI,{Hips:i,Spine:t}),C=i=>{let t={r:r.findRotation(i[23],i[25]),l:r.findRotation(i[24],i[26])};t.r.z=x(t.r.z-.5,-.5,0),t.r.y=0,t.l.z=x(t.l.z-.5,-.5,0),t.l.y=0;let e={r:r.findRotation(i[25],i[27]),l:r.findRotation(i[26],i[28])};e.r.x=r.angleBetween3DCoords(i[23],i[25],i[27]),e.r.y=0,e.r.z=0,e.l.x=r.angleBetween3DCoords(i[24],i[26],i[28]),e.l.y=0,e.l.z=0;let n=T(t.r,e.r,"Right"),o=T(t.l,e.l,"Left");return{UpperLeg:{r:n.UpperLeg,l:o.UpperLeg},LowerLeg:{r:n.LowerLeg,l:o.LowerLeg},Unscaled:{UpperArm:t,LowerLeg:e}}},T=(i,t,e="right")=>{let n=e==="Right"?1:-1;return i.z=i.z*-2.3*n,i.x=x(i.z*.1*n,-.5,Math.PI),t.x=t.x*-2.14*1.3,{UpperLeg:i,LowerLeg:t}};class A{constructor(){}static solve(t,e,{runtime:n="mediapipe",video:o=null,imageSize:a=null,enableLegs:h=!0}={}){if(!t&&!e){console.error("Need both World Pose and Pose Landmarks");return}if(o){let c=o;typeof o=="string"&&(c=document.querySelector(o)),a={width:c.videoWidth,height:c.videoHeight}}n==="tfjs"&&a&&(t.forEach((c,m)=>{c.visibility=c.score}),e.forEach((c,m)=>{c.x/=a.width,c.y/=a.height,c.z=0,c.visibility=c.score}));let s=H(t),y=U(t,e),l=C(t),z=t[15].y>-.1||t[15].visibility<.23||.995<e[15].y,g=t[16].y>-.1||t[16].visibility<.23||.995<e[16].y,p=t[23].visibility<.63||y.Hips.position.z>-.4,d=t[24].visibility<.63||y.Hips.position.z>-.4;return s.UpperArm.l=s.UpperArm.l.multiply(g?0:1),s.UpperArm.l.z=g?D.Pose.LeftUpperArm.z:s.UpperArm.l.z,s.UpperArm.r=s.UpperArm.r.multiply(z?0:1),s.UpperArm.r.z=z?D.Pose.RightUpperArm.z:s.UpperArm.r.z,s.LowerArm.l=s.LowerArm.l.multiply(g?0:1),s.LowerArm.r=s.LowerArm.r.multiply(z?0:1),s.Hand.l=s.Hand.l.multiply(g?0:1),s.Hand.r=s.Hand.r.multiply(z?0:1),l.UpperLeg.l=l.UpperLeg.l.multiply(d?0:1),l.UpperLeg.r=l.UpperLeg.r.multiply(p?0:1),l.LowerLeg.l=l.LowerLeg.l.multiply(d?0:1),l.LowerLeg.r=l.LowerLeg.r.multiply(p?0:1),{RightUpperArm:s.UpperArm.r,RightLowerArm:s.LowerArm.r,LeftUpperArm:s.UpperArm.l,LeftLowerArm:s.LowerArm.l,RightHand:s.Hand.r,LeftHand:s.Hand.l,RightUpperLeg:l.UpperLeg.r,RightLowerLeg:l.LowerLeg.r,LeftUpperLeg:l.UpperLeg.l,LeftLowerLeg:l.LowerLeg.l,Hips:y.Hips,Spine:y.Spine}}}P(A,"calcArms",H),P(A,"calcHips",U),P(A,"calcLegs",C);class K{constructor(){}static solve(t,e="Right"){if(!t){console.error("Need Hand Landmarks");return}let n=[new r(t[0]),new r(t[e==="Right"?17:5]),new r(t[e==="Right"?5:17])],o=r.rollPitchYaw(n[0],n[1],n[2]);o.y=o.z,o.y-=e==="Left"?.3:.5;let a={};return a[e+"Wrist"]={x:o.x,y:o.y,z:o.z},a[e+"RingProximal"]={x:0,y:0,z:r.angleBetween3DCoords(t[0],t[13],t[14])},a[e+"RingIntermediate"]={x:0,y:0,z:r.angleBetween3DCoords(t[13],t[14],t[15])},a[e+"RingDistal"]={x:0,y:0,z:r.angleBetween3DCoords(t[14],t[15],t[16])},a[e+"IndexProximal"]={x:0,y:0,z:r.angleBetween3DCoords(t[0],t[5],t[6])},a[e+"IndexIntermediate"]={x:0,y:0,z:r.angleBetween3DCoords(t[5],t[6],t[7])},a[e+"IndexDistal"]={x:0,y:0,z:r.angleBetween3DCoords(t[6],t[7],t[8])},a[e+"MiddleProximal"]={x:0,y:0,z:r.angleBetween3DCoords(t[0],t[9],t[10])},a[e+"MiddleIntermediate"]={x:0,y:0,z:r.angleBetween3DCoords(t[9],t[10],t[11])},a[e+"MiddleDistal"]={x:0,y:0,z:r.angleBetween3DCoords(t[10],t[11],t[12])},a[e+"ThumbProximal"]={x:0,y:0,z:r.angleBetween3DCoords(t[0],t[1],t[2])},a[e+"ThumbIntermediate"]={x:0,y:0,z:r.angleBetween3DCoords(t[1],t[2],t[3])},a[e+"ThumbDistal"]={x:0,y:0,z:r.angleBetween3DCoords(t[2],t[3],t[4])},a[e+"LittleProximal"]={x:0,y:0,z:r.angleBetween3DCoords(t[0],t[17],t[18])},a[e+"LittleIntermediate"]={x:0,y:0,z:r.angleBetween3DCoords(t[17],t[18],t[19])},a[e+"LittleDistal"]={x:0,y:0,z:r.angleBetween3DCoords(t[18],t[19],t[20])},a=Z(a,e),a}}const Z=(i,t="Right")=>{const e=t==="Right"?1:-1;let n=["Ring","Index","Little","Thumb","Middle"],o=["Proximal","Intermediate","Distal"];return i[t+"Wrist"].x=x(i[t+"Wrist"].x*2*e,-.3,.3),i[t+"Wrist"].y=x(i[t+"Wrist"].y*2.3,t==="Right"?-1:-.6,t==="Right"?.6:1),i[t+"Wrist"].z=x(i[t+"Wrist"].z*-2.3*e),n.forEach(a=>{o.forEach(h=>{let s=i[t+a+h];if(a==="Thumb"){let y={x:h==="Proximal"?2.2:0,y:h==="Proximal"?2.2:h==="Intermediate"?.7:1,z:.5},l={x:h==="Proximal"?1.2:-.2,y:h==="Proximal"?1.1*e:.1*e,z:.2*e},z={x:0,y:0,z:0};h==="Proximal"?(z.z=x(l.z+s.z*-Math.PI*y.z*e,t==="Right"?-.6:-.1,t==="Right"?.1:.6),z.x=x(l.x+s.z*-Math.PI*y.x,-.6,.1),z.y=x(l.y+s.z*-Math.PI*y.y*e,t==="Right"?-1.6:-.1,t==="Right"?.1:1.6)):(z.z=x(l.z+s.z*-Math.PI*y.z*e,-2,2),z.x=x(l.x+s.z*-Math.PI*y.x,-2,2),z.y=x(l.y+s.z*-Math.PI*y.y*e,-2,2)),s.x=z.x,s.y=z.y,s.z=z.z}else s.z=x(s.z*-Math.PI*e,t==="Right"?-2.3:0,t==="Right"?0:2.3)})}),i},G=i=>{let t=new r(i[21]),e=new r(i[251]),n=new r(i[397]),o=new r(i[172]),a=n.lerp(o,.5);return{vector:[t,e,a],points:[t,e,n,o]}},J=i=>{let t=r.rollPitchYaw(i[0],i[1],i[2]),e=i[0].lerp(i[1],.5),n=i[0].distance(i[1]),o=e.distance(i[2]);return t.x*=-1,t.z*=-1,{y:t.y*Math.PI,x:t.x*Math.PI,z:t.z*Math.PI,width:n,height:o,position:e.lerp(i[2],.5),normalized:{y:t.y,x:t.x,z:t.z},degrees:{y:t.y*180,x:t.x*180,z:t.z*180}}},Q=i=>{const t=G(i);return J(t.vector)},w={eye:{left:[130,133,160,159,158,144,145,153],right:[263,362,387,386,385,373,374,380]},brow:{left:[35,244,63,105,66,229,230,231],right:[265,464,293,334,296,449,450,451]},pupil:{right:[468,469,470,471,472],left:[473,474,475,476,477]}},O=(i,t="left")=>{let e=w.brow[t],n=E(i[e[0]],i[e[1]],i[e[2]],i[e[3]],i[e[4]],i[e[5]],i[e[6]],i[e[7]]),o=1.15,a=.125,h=.07,s=n/o-1;return(x(s,h,a)-h)/(a-h)},W=(i,t="left")=>{let e=w.eye[t],n=E(i[e[0]],i[e[1]],i[e[2]],i[e[3]],i[e[4]],i[e[5]],i[e[6]],i[e[7]]),o=.285,a=.85,h=.55,s=x(n/o,0,2);return{norm:f(s,h,a),raw:s}},E=(i,t,e,n,o,a,h,s)=>{i=new r(i),t=new r(t),e=new r(e),n=new r(n),o=new r(o),a=new r(a),h=new r(h),s=new r(s);const y=i.distance(t,2),l=e.distance(a,2),z=n.distance(h,2),g=o.distance(s,2);return(l+z+g)/3/y},Y=(i,t="left")=>{const e=new r(i[w.eye[t][0]]),n=new r(i[w.eye[t][1]]),o=e.distance(n,2),a=e.lerp(n,.5),h=new r(i[w.pupil[t][0]]),s=a.x-h.x,y=a.y-o*.075-h.y;let l=s/(o/2),z=y/(o/4);return l*=4,z*=4,{x:l,y:z}},q=(i,t,e=!1,n=12)=>{i.r=x(i.r,0,1),i.l=x(i.l,0,1);const o=Math.abs(i.l-i.r),a=e?1.1:.8,h=i.l<.3&&i.r<.3,s=i.l>.6&&i.r>.6;return t>n?{l:i.r,r:i.r}:t<-1*n?{l:i.l,r:i.l}:{l:o>=a&&!h&&!s?i.l:i.r>i.l?r.lerp(i.r,i.l,.95):r.lerp(i.r,i.l,.05),r:o>=a&&!h&&!s?i.r:i.r>i.l?r.lerp(i.r,i.l,.95):r.lerp(i.r,i.l,.05)}},$=i=>{if(i.length<=468)return{l:1,r:1};const t=W(i,"left"),e=W(i,"right");return{l:t.norm,r:e.norm}},j=i=>{if(i.length<=468)return{x:0,y:0};{const t=Y(i,"left"),e=Y(i,"right");return{x:(t.x+e.x)*.5,y:(t.y+e.y)*.5}}},v=i=>{if(i.length<=468)return 0;{const t=O(i,"left"),e=O(i,"right");return(t+e)/2}},b=(i,t,e="mediapipe")=>{const n=new r(i[133]),o=new r(i[362]),a=new r(i[130]),h=new r(i[263]),s=n.distance(o),y=a.distance(h),l=new r(i[13]),z=new r(i[14]),g=new r(i[61]),p=new r(i[291]),d=l.distance(z),c=g.distance(p);let m=c/d,I=d/s,L=c/y;I=f(I,.17,.5),L=f(L,.45,.9),L=(L-.3)*2;const R=I,k=e==="facemesh"?1.3:0;let M=f(m,1.3+k*.8,2.6+k)*f(R,.7,1),V=R*.2+R*(1-M)*.8,S=R*f(1-M,0,.3)*.1,tt=f(S,.2,1)*(1-M)*.3,et=(1-M)*f(R,.5,1)*.2;return{x:L,y:I,shape:{A:V,E:tt,I:M,O:et,U:S}}},_=(i,t,e)=>b(i,t,e);class F{constructor(){this.head={x:0,y:0,z:0},this.mouth={x:0,y:0},this.eye={l:1,r:1,indep:{l:1,r:1}},this.brow=0,this.pupil={x:0,y:0}}static solve(t,{runtime:e="mediapipe",smoothBlink:n=!0}={}){if(!t){console.error("Need Face Landmarks");return}let o=Q(t),a=$(t);n&&(a=q(a,o.x));let h=j(t),s=_(t,o.x,e),y=v(t,o.x);return{head:o,eye:a,brow:y,pupil:h,mouth:s}}}P(F,"stabilizeBlink",q),u.Face=F,u.Hand=K,u.Pose=A,u.Utils=X,u.Vector=r,Object.defineProperty(u,"__esModule",{value:!0}),u[Symbol.toStringTag]="Module"});
